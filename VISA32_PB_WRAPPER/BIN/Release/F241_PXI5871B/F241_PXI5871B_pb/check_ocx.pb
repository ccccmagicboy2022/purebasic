  ;05/13/2013 20:17:58
  IncludePath "BIN"
  XIncludeFile  "COMatePLUS.pbi"
  
  Macro AddIncludeFile(num, In)
    DataSection
      file_start#num:
        IncludeBinary In
      file_end#num:
    EndDataSection   
  EndMacro
  
  Procedure SetWinTransparency(win, level)
    If level>=0 And level<101
      hLib = LoadLibrary_("user32.dll")
      If hLib
        adr = GetProcAddress_(hLib, "SetLayeredWindowAttributes")
        If adr
          SetWindowLong_(WindowID(win), #GWL_EXSTYLE, GetWindowLong_(WindowID(win), #GWL_EXSTYLE)|$00080000) ; #WS_EX_LAYERED = $00080000
          CallFunctionFast(adr, WindowID(win), 0, 255*level/100, 2)
        EndIf
        FreeLibrary_(hLib)
      EndIf
    EndIf
  EndProcedure    
  
  AddIncludeFile(0, "LED.ocx")
  AddIncludeFile(1, "pxi5871r1-j1.png")
  AddIncludeFile(2, "pxi5871r1-j2.png")
  AddIncludeFile(3, "pxi5871r2-j1.png")
  AddIncludeFile(4, "pxi5871r2-j2.png")
  AddIncludeFile(5, "UART.jpg")
  
  ProcedureDLL.l  check_ocx()
    
    WSysName.s = Space(255)
    GetSystemDirectory_(WSysName, @Null)
    WSysName  = WSysName  + "\"    
    file1_name.s  = WSysName + "LED.ocx"
    result = FileSize(file1_name)
    If  result > 0
      ;
    Else
      If  result = -1
        file1 = CreateFile(#PB_Any, file1_name)
        WriteData(file1, ?file_start0, ?file_end0 - ?file_start0)
        CloseFile(file1)
      EndIf
    EndIf  
        
    result  = COMate_RegisterCOMServer(file1_name)
    If result = #S_OK
      ;
    Else
      MessageBox_(GetFocus_(), file1_name + " ocx reg error!", file1_name, #MB_OK|#MB_ICONERROR|#MB_SYSTEMMODAL) 
    EndIf  
  
  EndProcedure
  
  Procedure.l pxi5871_r_pinout(model)
    UsePNGImageDecoder()
    UseJPEGImageDecoder()
    
    image1  = CatchImage(#PB_Any, ?file_start1)
    image2  = CatchImage(#PB_Any, ?file_start2)
    image3  = CatchImage(#PB_Any, ?file_start3)
    image4  = CatchImage(#PB_Any, ?file_start4)
    image5  = CatchImage(#PB_Any, ?file_start5)
    
    Select  model
      Case  0:
        image_width.l = ImageWidth(image1)
        image_height.l  = ImageHeight(image1)
      Case  1:
        image_width = ImageWidth(image2)
        image_height  = ImageHeight(image2)
      Case  2:
        image_width = ImageWidth(image3)
        image_height  = ImageHeight(image3)        
      Case  3:
        image_width = ImageWidth(image4)
        image_height  = ImageHeight(image4)
      Case  4:
        image_width = ImageWidth(image5)
        image_height  = ImageHeight(image5)       
      Default:
        ProcedureReturn  #False
    EndSelect
    
    Protected hwnd = OpenWindow(#PB_Any, 0, 0, image_width, image_height, "cv", #PB_Window_SystemMenu|#PB_Window_ScreenCentered|#PB_Window_BorderLess)
    
    Select  model
      Case  0:
        image1_ig = ImageGadget(#PB_Any, 0, 0, image_width, image_height, ImageID(image1))
      Case  1:
        image1_ig = ImageGadget(#PB_Any, 0, 0, image_width, image_height, ImageID(image2))
      Case  2:
        image1_ig = ImageGadget(#PB_Any, 0, 0, image_width, image_height, ImageID(image3))
      Case  3:
        image1_ig = ImageGadget(#PB_Any, 0, 0, image_width, image_height, ImageID(image4))
      Case  4:
        image1_ig = ImageGadget(#PB_Any, 0, 0, image_width, image_height, ImageID(image5))
    EndSelect
    
    StickyWindow(hwnd, 1)
    SetWinTransparency(hwnd, 90)
        
    Repeat
      Event.l = WaitWindowEvent()
      Select  Event
        Case  #PB_Event_Timer
          Select  EventTimer()
            Case  0
              ;
          EndSelect
        Case  #PB_Event_Gadget
          Select  EventGadget()
            Case  image1_ig
              quit  = #True
          EndSelect
        Case  #PB_Event_Menu
          Select EventMenu()
            Case  0
              ;
          EndSelect
      EndSelect
    Until Event = #PB_Event_CloseWindow Or  quit  = #True    
   
    CloseWindow(hwnd)      
    
  EndProcedure  
  
  ProcedureDLL.l  pxi5871_r_pinout_thread(model)
    ProcedureReturn CreateThread(@pxi5871_r_pinout(), model)  
  EndProcedure
  
;
; PureBUILD Build = 2 [generated by PureBUILD Plugin]
; IDE Options = PureBasic 5.00 (Windows - x86)
; ExecutableFormat = Shared Dll
; CursorPosition = 101
; FirstLine = 55
; Folding = -
; EnableThread
; EnableXP
; Executable = Release\F241_PXI5871B.dll
; CompileSourceDirectory
; EnableCompileCount = 40
; EnableBuildCount = 9
; EnableExeConstant
; IncludeVersionInfo
; VersionField0 = 1,0,0,%BUILDCOUNT
; VersionField1 = 1,0,0,%BUILDCOUNT
; VersionField2 = cv
; VersionField3 = %EXECUTABLE@%OS
; VersionField4 = 1,0,0,%BUILDCOUNT
; VersionField5 = 1,0,0,%BUILDCOUNT
; VersionField6 = cv
; VersionField7 = cv
; VersionField8 = cv
; VersionField18 = CCCC
; VersionField19 = cv
; VersionField20 = cuiwei
; VersionField21 = cccc
; VersionField22 = 2012
; VersionField23 = cuiwei