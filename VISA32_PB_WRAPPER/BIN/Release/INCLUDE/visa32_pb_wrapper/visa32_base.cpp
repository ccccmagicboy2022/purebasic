//
//
//  Generated by StarUML(tm) C++ Add-In
//
//  @ Project : VISA32_PB_WRAPPER_CLASS
//  @ File Name : visa32_base.cpp
//  @ Date : 2013/6/25
//  @ Author : cv
//
//

#include	"visa32_base.h"
#include	"VISA32_PB_WRAPPER_DLL.h"			//VISA32_PB_WRAPPER DLL header file

visa32_base::visa32_base():	is_visalib_error(true)
{
	if (VISA32_PB_WRAPPER_DLL::visa_check_setup())
	{
		VISA32_PB_WRAPPER_DLL::load_wrapper_dll();
		VISA32_PB_WRAPPER_DLL::splash_launcher("cccc copyright 2013");
		is_visalib_error	=	false;
	}
	else
	{
		is_visalib_error	=	true;
		::MessageBox(GetFocus(), "visa32 lib setup error!", "-=cv=-", MB_OK|MB_SYSTEMMODAL|MB_ICONERROR);
	}
}

visa32_base::~visa32_base()
{
	if (!is_visalib_error)
	{
		VISA32_PB_WRAPPER_DLL::close_wrapper_dll();
	}
}

bool visa32_base::get_visalib_status() {
	return	is_visalib_error;
}
