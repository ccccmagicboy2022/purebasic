///AG34410A类的实现
/**
 * @file
 * @author  Cui Wei <cuiwei_cv@163.com>
 * @version 1.0
 *
 * @section LICENSE
 *
 * This program is not free software, and you must pay for it!
 *
 * @section DESCRIPTION
 *
 * AG34410A类的定义
 */
//
//
//  Generated by StarUML(tm) C++ Add-In
//
//  @ Project : VISA32_PB_WRAPPER_CLASS
//  @ File Name : AG34410A.cpp
//  @ Date : 2013/6/18
//  @ Author : cv
//
//

#include	"AG34410A.h"										//包含自已的头文件
#include	"visa/visa.h"										//使用ni-visa的库函数
#include	"VISA32_PB_WRAPPER_DLL.h"			//VISA32_PB_WRAPPER DLL header file

AG34410A::AG34410A() {
	device_id	=	new char[1024]();
	strcpy(device_id, "abcd");
}

AG34410A::~AG34410A() {
	delete	[]	device_id;
}

bool AG34410A::select_visa_usb_device() const{
	return	VISA32_PB_WRAPPER_DLL::select_visa_usb_device(get_device_rscs(), 0x0957, 0x0607);
}

void AG34410A::clear() const{
	viPrintf(get_device_res(), "*CLS\n");
}

void AG34410A::reset() const{
	viPrintf(get_device_res(), "*RST\n");
}

void AG34410A::identify() const{
	viQueryf(get_device_res(), "*IDN?\n", "%t", device_id);
}

double AG34410A::read_dci(const	DWORD param1) const{
	double	result	=	0;
	const	char*	const	scale0	=	"MEAS:CURR:DC? AUTO\n";		//自动档
	//const	char*	const	scale1	=	"MEAS:CURR:DC? 1,1E-7\n";	//1A档
	const	char*	const	scale1	=	"MEAS:CURR:DC? 1,MAX\n";	//1A档
	//const	char*	const	scale2	=	"MEAS:CURR:DC? 0.1,1E-8\n";	//100mA档
	const	char*	const	scale2	=	"MEAS:CURR:DC? 0.1,MAX\n";	//100mA档
	//const	char*	const	scale3	=	"MEAS:CURR:DC? 0.01,1E-9\n";//10mA档
	const	char*	const	scale3	=	"MEAS:CURR:DC? 0.01,MAX\n";//10mA档

	switch	(param1)
	{
	case 0:
		viQueryf(get_device_res(), (char*)scale0, "%lf", &result);
		break;
	case 1:
		viQueryf(get_device_res(), (char*)scale1, "%lf", &result);
		break;
	case 2:
		viQueryf(get_device_res(), (char*)scale2, "%lf", &result);
		break;
	case 3:
		viQueryf(get_device_res(), (char*)scale3, "%lf", &result);
		break;		
	default:
		break;
	}
	return	result;
}

double AG34410A::read_dcv(const	DWORD param1) const{
	double	result	=	0;
	const	char*	const	scale0	=	"MEAS:VOLT:DC? AUTO\n";		//自动档
	//const	char*	const	scale1	=	"MEAS:VOLT:DC? 100,1E-5\n";	//100V档
	const	char*	const	scale1	=	"MEAS:VOLT:DC? 100,MAX\n";	//100V档
	//const	char*	const	scale2	=	"MEAS:VOLT:DC? 10,1E-6\n";	//10V档
	const	char*	const	scale2	=	"MEAS:VOLT:DC? 10,MAX\n";	//10V档

	switch	(param1)
	{
	case 0:
		viQueryf(get_device_res(), (char*)scale0, "%lf", &result);
		break;
	case 1:
		viQueryf(get_device_res(), (char*)scale1, "%lf", &result);
		break;
	case 2:
		viQueryf(get_device_res(), (char*)scale2, "%lf", &result);
		break;	
	default:
		break;
	}
	return	result;
}

void AG34410A::display(const	char*	const param1, const	char*	const param2) const{
	viPrintf(get_device_res(), "DISP:WIND1:TEXT \'%s\'\n", param1);
	viPrintf(get_device_res(), "DISP:WIND2:TEXT \'%s\'\n", param2);
}

double AG34410A::read_res(const DWORD param1) const
{
	double	result	=	0;
	const	char*	const	scale0	=	"MEAS:RES? AUTO\n";		//2线自动档
	const	char*	const	scale1	=	"MEAS:RES? 1000,MAX\n";	//2线1000欧档
	const	char*	const	scale2	=	"MEAS:RES? 100,MAX\n";	//2线100欧档
	const	char*	const	scale3	=	"MEAS:FRES? AUTO\n";		//4线自动档
	const	char*	const	scale4	=	"MEAS:FRES? 1000,MAX\n";	//4线1000欧档
	const	char*	const	scale5	=	"MEAS:FRES? 100,MAX\n";		//4线100欧档

	switch	(param1)
	{
	case 0:
		viQueryf(get_device_res(), (char*)scale0, "%lf", &result);
		break;
	case 1:
		viQueryf(get_device_res(), (char*)scale1, "%lf", &result);
		break;
	case 2:
		viQueryf(get_device_res(), (char*)scale2, "%lf", &result);
		break;
	case 3:
		viQueryf(get_device_res(), (char*)scale3, "%lf", &result);
		break;
	case 4:
		viQueryf(get_device_res(), (char*)scale4, "%lf", &result);
		break;
	case 5:
		viQueryf(get_device_res(), (char*)scale5, "%lf", &result);
		break;	
	default:
		break;
	}
	return	result;
}
