///visa32_device类的声明
/**
 * @file
 * @author  Cui Wei <cuiwei_cv@163.com>
 * @version 1.0
 *
 * @section LICENSE
 *
 * This program is not free software, and you must pay for it!
 *
 * @section DESCRIPTION
 *
 * visa32_device类的声明
 */
//
//
//  Generated by StarUML(tm) C++ Add-In
//
//  @ Project : VISA32_PB_WRAPPER_CLASS
//  @ File Name : visa32_device.h
//  @ Date : 2013/6/17
//  @ Author : cv
//
//
#include	<Windows.h>		//增加winapi支持

#if !defined(_VISA32_DEVICE_H)
#define _VISA32_DEVICE_H

///visa32设备基类，也可以用来定义对象
/** 
 *	常用于非PXI/PCI设备，如USB/GPIB/串口等
 *	@since	12/16/2012	
 */
class visa32_device {
private:
	///visa资源名字符指针
	char* device_rscs;	/**< 例如：USB0::0x0957::0x0607::MY47013374::INSTR */
	///当前资源的session id
	DWORD device_res;	/**< 在init()内赋值 */
	///ni-visa库的主资源session id
	DWORD visa_default;	/**< 在default constructor内赋值 */
	///外部不可见的资源健康信号
	bool health;		/**< true时可release, false时可init */
public:
	///visa32_device类默认的构造函数
	/** 
	 *	初始化所有非类成员变量,打开默认的visa管理器ID，为字串指针申请足够大的HEAP(堆)空间
	 */
	visa32_device();
	///visa32_device类默认的析构函数
	/** 
	 *	close默认的visa管理器ID，释放字串指针申请的HEAP(堆)空间
	 */		
	~visa32_device();
	///选择要操作的VISA32资源（包括所有的）
	/** 
	 *	选择从窗体要使用的资源字串
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */
	bool select_visa_device()	const;
	///选择要操作的VISA32资源（只串口）
	/** 
	 *	选择从窗体要使用的资源字串
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	bool select_visa_serialport()	const;
	///选择要操作的USB资源
	/** 
	 *	从窗体中选择要使用的板卡字串；导出类可以重写此函数
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	virtual	bool select_visa_usb_device()	const;
	///选择要操作的PCI/PXI资源
	/** 
	 *	从窗体中选择要使用的板卡字串；导出类可以重写此函数
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	virtual	bool select_visa_pci_pxi_card()	const;
	///选择要操作的VISA32资源（只GPIB资源）
	/** 
	 *	从窗体中选择要使用的资源字串
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	bool select_visa_gpib_device()	const;
	///选择支持LXI的VISA32设备
	/** 
	 *	从窗体中选择要使用的资源字串
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	bool select_visa_lxi_device()	const;
	///选择要操作的VISA32总线，引导进入选择资源
	/** 
	 *	从窗体中获取要使用的资源字串
	 *	@param		[in]	mask使能bit8~bit0代表界面中的顺序选项的使能开关
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	bool select_visa_bus(DWORD mask)	const;
	///初始化板卡资源ID，注册错误处理handler函数
	/** 
	 *	@retval		true	成功
	 *	@retval		false	失败	 
	 */		
	virtual	bool init();
	///释放板卡资源ID，取消注册错误处理handler函数
	/** 
	 *	@return		void
	 */		
	virtual	bool release();
	///使用另一个字符指针为成员变量device_rscs所指内存区赋值
	/** 
	 *	@param		[in]	param1	字符指针
	 *	@return		void
	 */	
	void set_device_rscs(const	char*	const param1)	const;
	///获取成员变量device_rscs的值
	/** 
     * 	@return		成员变量device_rscs
	 */	
	inline	char* get_device_rscs()	const	{	return	device_rscs;}
	///读取已打开的板卡资源ID
	/** 
	 *	@return		板卡资源ID	device_res
	 */	
	inline	DWORD get_device_res()	const	{	return	device_res;}
	///读取visa32的主资源ID
	/** 
	 *	@return		visa32主资源ID	visa_default
	 */		
	inline	DWORD get_visa_default()	const	{	return	visa_default;}
	///运行visa_interactive_io窗体
	/** 
	 *	@return		void
	 *	@see		VISA32_PB_WRAPPER_DLL::visa_interactive_io()
	 */		
	void visa_interactive_io()	const;
};

#endif  //_VISA32_DEVICE_H
